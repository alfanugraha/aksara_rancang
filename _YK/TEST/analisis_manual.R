#Directory : Indonesia bagian BARAT

##ACEH
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Aceh/06_input_primer.csv"     

##BABEL
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Babel/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Babel/02_permintaan_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Babel/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Babel/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Babel/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Babel/06_input_primer.csv" 

##BENGKULU
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Bengkulu/06_input_primer.csv" 

##JAMBI
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Jambi/06_input_primer.csv" 

##KEPRI
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/05_komponen_input_primer (dengan impor).csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Kepri/06_input_primer (dengan impor).csv" 

##LAMPUNG
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/05_komponen_input_primer (dengan impor).csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Lampung/06_input_primer (dengan impor).csv" 

##RIAU
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Riau/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Riau/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Riau/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Riau/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Riau/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Riau/06_input_primer.csv" 

##SUMBAR
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Sumbar/06_input_primer.csv" 

##SUMSEL
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/02_input_antara_2.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/04_permintaan_akhir_2.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Sumsel/06_input_primer_2.csv" 

##SUMUT
inSector <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/01_sektor.csv"
inIntermediateDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/02_input_antara.csv"
inFinalDemandComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/03_komponen_permintaan_akhir.csv"
inFinalDemand <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/04_permintaan_akhir.csv"
inAddedValueComp <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/05_komponen_input_primer.csv"
inAddedValue <- "Tabel_IO_REDCLUW/01 BARAT/Sumut/06_input_primer.csv" 

#Read the data
sector <- read.table(inSector, header=FALSE, sep=",")
indem <- read.table(inIntermediateDemand, header=FALSE, sep=",")
findem <- read.table(inFinalDemand, header=FALSE, sep=",")
addval <- read.table(inAddedValue, header=FALSE, sep=",")
findemcom <- read.table(inFinalDemandComp, header=FALSE, sep=",")
addvalcom <- read.table(inAddedValueComp, header=FALSE, sep=",")

#Convert to matrix
income_row <- 2
indem_matrix <- as.matrix(indem)
addval_matrix <- as.matrix(addval)
num_addval <- nrow(addval_matrix)
dimensi <- ncol(indem_matrix)

indem_colsum <- colSums(indem_matrix)
addval_colsum <- colSums(addval_matrix)
fin_con <- 1/(indem_colsum+addval_colsum)
fin_con[is.infinite(fin_con)] <- 0
tinput_invers <- diag(fin_con)
A <- indem_matrix %*% tinput_invers
I <- as.matrix(diag(dimensi))
I_A <- I-A
library(matlib)
leontief <- inv(I_A)
#leontief <- solve(I_A) {Mempengaruhi hasil desimal}

# Backward Linkage
BL <- colSums(leontief)
BL <- BL/(mean(BL))
# Forward Linkage
FL <- rowSums(leontief)
FL <- FL/(mean(FL))
# GDP (bentuk kondisi dimana tidak ada "Impor" pada input primer)
if(addvalcom$V1[1]=="Impor"){
  GDP <- colSums(addval_matrix[2:num_addval,])
} else {
  GDP <- colSums(addval_matrix[1:num_addval,])
}
# Multiplier Output
multiplierOutput <- colSums(leontief)
# Multiplier Income (bentuk kondisi dimana tidak ada "Impor" pada input primer)
if(addvalcom$V1[1]=="Impor"){
  income_coef <- tinput_invers %*% as.matrix(addval_matrix[income_row,])
} else {
  income_coef <- tinput_invers %*% as.matrix(addval_matrix[(income_row-1),])
}
##income_matrix <- diag(as.vector(income_coef), ncol = dimensi, nrow = dimensi)
##InvIncome_matrix <- diag(as.vector(1/income_coef), ncol = dimensi, nrow = dimensi)
##multiplierIncome <- solve(leontief,income_coef) {Mempengaruhi hasil desimal}
multiplierIncome <- leontief %*% income_coef
#multiplierIncome <- as.matrix(colSums(multiplierIncome), dimensi, 1)
multiplierIncome[is.na(multiplierIncome)] <- 0

result <- cbind(sector,
                GDP,
                multiplierOutput,
                BL,
                FL, 
                income_coef,
                multiplierIncome
)
colnames(result)[1] <- "Sektor"
View(result)
